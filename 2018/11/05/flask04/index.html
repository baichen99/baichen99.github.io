<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="https://s2.ax1x.com/2019/06/13/VhRMGV.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="https://s2.ax1x.com/2019/06/13/VhRMGV.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="https://s2.ax1x.com/2019/06/13/VhRMGV.png?v=5.1.4">


  <link rel="mask-icon" href="https://s2.ax1x.com/2019/06/13/VhRMGV.pngg?v=5.1.4" color="#222">





  <meta name="keywords" content="flask,模板," />










<meta name="description" content="flask使用的默认模板引擎是jinja2 模板语法三种界定符 语句，比如if、for   {% ... %}    表达式比如字符串，变量，函数调用   {{ ... }}    注释   {# ... #}   在jinja2使用.来获取变量的属性，比如user字典中的username键值通过.来获取j，即user.username, 等同于user[username]  jinja2并不支持">
<meta property="og:type" content="article">
<meta property="og:title" content="flask04-模板">
<meta property="og:url" content="http://blacston.com/2018/11/05/flask04/index.html">
<meta property="og:site_name" content="黑石的技术笔记">
<meta property="og:description" content="flask使用的默认模板引擎是jinja2 模板语法三种界定符 语句，比如if、for   {% ... %}    表达式比如字符串，变量，函数调用   {{ ... }}    注释   {# ... #}   在jinja2使用.来获取变量的属性，比如user字典中的username键值通过.来获取j，即user.username, 等同于user[username]  jinja2并不支持">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-11-05T11:42:03.000Z">
<meta property="article:modified_time" content="2021-01-16T03:39:21.272Z">
<meta property="article:author" content="baichen">
<meta property="article:tag" content="flask">
<meta property="article:tag" content="模板">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blacston.com/2018/11/05/flask04/"/>





  <title>flask04-模板 | 黑石的技术笔记</title>
  








<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">黑石的技术笔记</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blacston.com/2018/11/05/flask04/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="黑石的技术笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">flask04-模板</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-05T19:42:03+08:00">
                2018-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flask%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">flask学习笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>flask使用的默认模板引擎是<code>jinja2</code></p>
<h2 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h2><h3 id="三种界定符"><a href="#三种界定符" class="headerlink" title="三种界定符"></a>三种界定符</h3><ol>
<li>语句，比如if、for</li>
</ol>

{% ... %} 

<ol start="2">
<li>表达式比如字符串，变量，函数调用</li>
</ol>

{{ ... }}


<ol start="3">
<li>注释</li>
</ol>

{# ... #}


<p>在jinja2使用<code>.</code>来获取变量的属性，比如user字典中的username键值通过<code>.</code>来获取j，即<code>user.username</code>, 等同于<code>user[username]</code></p>
<ol>
<li>jinja2并不支持所有Python所有语法，使用处于效率和代码组织等方面考虑<strong>应该适度使用模板，仅把和输出控制有关的逻辑操作放到模板中</strong></li>
<li>Jinja2提供了多种控制结构来控制模板的输出，其中<code>for</code> 和 <code>if</code> 是最常用的两种，在语句结束时要添加 <strong>结束标签</strong></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if user.bio %&#125;</span><br><span class="line">&lt;i&gt; &#123;&#123; user.bio &#125;&#125; &lt;&#x2F;i&gt;</span><br><span class="line">&#123;% else %&#125;</span><br><span class="line">&lt;i&gt; This user has not provided a bio. &lt;&#x2F;i&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">&#123;% for movie in movies %&#125;</span><br><span class="line">&lt;li&gt; &#123;&#123; movie.name &#125;&#125; -- &#123;&#123; movie.year &#125;&#125; &lt;&#x2F;li&gt;</span><br><span class="line">&lt;&#x2F;ul&gt;</span><br></pre></td></tr></table></figure>
<h3 id="for循环特殊变量"><a href="#for循环特殊变量" class="headerlink" title="for循环特殊变量"></a>for循环特殊变量</h3><table>
<thead>
<tr>
<th align="center">变量名</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">loop.index</td>
<td align="center">当前迭代数（从1开始计数）</td>
</tr>
<tr>
<td align="center">loop.index()</td>
<td align="center">当前迭代书（从0开始计数）</td>
</tr>
<tr>
<td align="center">loop.revindex</td>
<td align="center">当前反向迭代数（从1开始计数）</td>
</tr>
<tr>
<td align="center">loop.revindex()</td>
<td align="center">当前反向迭代数（从0开始计数）</td>
</tr>
<tr>
<td align="center">loop.first</td>
<td align="center">如果时第一个元素则返回True</td>
</tr>
<tr>
<td align="center">loop.last</td>
<td align="center">如果时最后一个元素则返回True</td>
</tr>
<tr>
<td align="center">loop.previtem</td>
<td align="center">上一迭代条目</td>
</tr>
<tr>
<td align="center">loop.nextitem</td>
<td align="center">下一迭代条目</td>
</tr>
<tr>
<td align="center">loop.length</td>
<td align="center">序列包含的元素数量</td>
</tr>
</tbody></table>
<h3 id="渲染模板"><a href="#渲染模板" class="headerlink" title="渲染模板"></a>渲染模板</h3><p>渲染一个模板就是执行模板中的代码，并传入所有在模板中使用的变量，渲染后的结果就是我们要返回客户端的HTML响应，在视图函数中我们并不直接使用Jinjia2提供的函数，而是使用Flask提供的渲染函数<code>render_template()</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/watchlist&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">watchlist</span>():</span></span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&quot;watchlist.html&quot;</span>, user=user, movies=movies)</span><br></pre></td></tr></table></figure>
<p>在<code>render_template()</code>函数中，第一个参数时模板的文件名, Flask会在程序根目录下的templates文件夹里寻找模板文件，所以这里传入的路径时相对于templates根目录的。以关键字的形式传入了模板中使用的变量值，其他类型的变量通过相同的方式传入，传入的变量值可以时字符串、列表和字典，也可以时函数、类和实例</p>
<p>如果想传入函数，在模板调用，那么需要传入函数对象本身，而不是函数调用（函数的返回值），使用仅写出函数名即可，传入模板后，在函数名称后面添加括号以调用，以可以在括号中传入参数</p>
<h2 id="模板辅助工具"><a href="#模板辅助工具" class="headerlink" title="模板辅助工具"></a>模板辅助工具</h2><h3 id="上下文"><a href="#上下文" class="headerlink" title="上下文"></a>上下文</h3><p>模板上下文包含了很多变量，其中包裹我们调用<code>render_template()</code>时传入的变量，除了在渲染时传入变量，也可以在模板中定义d变量，使用{% %}标签</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set navigation &#x3D;[ (&#39;&#x2F;&#39;, &#39;Home&#39;), (&#39;&#x2F;about&#39;, &#39;About&#39;) ] %&#125;</span><br></pre></td></tr></table></figure>
<p>也可以将一部分模板数据定义为变量使用 <code>set</code>和<code>endset</code>来声明开始和结束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set navigation %&#125;</span><br><span class="line">&lt;li&gt;&lt;a href&#x3D;&quot;&#x2F;&quot;&gt;Home&lt;&#x2F;li&gt;</span><br><span class="line">&lt;li&gt;&lt;a href&#x3D;&quot;&#x2F;about&quot;&gt;About&lt;&#x2F;li&gt;</span><br><span class="line">&#123;% endset %&#125;</span><br></pre></td></tr></table></figure>
<h4 id="内置上下文变量"><a href="#内置上下文变量" class="headerlink" title="内置上下文变量"></a>内置上下文变量</h4><table>
<thead>
<tr>
<th align="center">变量</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">config</td>
<td align="center">当前的配置对象</td>
</tr>
<tr>
<td align="center">request</td>
<td align="center">当前的请求对象，在已激活的请求环境下可用</td>
</tr>
<tr>
<td align="center">session</td>
<td align="center">当前的会话对象，在已激活的请求环境下可用</td>
</tr>
<tr>
<td align="center">g</td>
<td align="center">与请求绑定的全局变量，在已激活的请求环境下可用</td>
</tr>
</tbody></table>
<h4 id="自定义上下文"><a href="#自定义上下文" class="headerlink" title="自定义上下文"></a>自定义上下文</h4><p>如果很多个模板都需要使用同一变量，那么可以设置一个模板全局变量避免在多个视图函数中重复传入。flask提供了一个<code>app.context_processor</code>装饰器，可以用来注册模板上下文处理函数，它可以帮我们完成统一传入变量的工作。模板上下文处理函数需要返回一个<strong>包含变量键值对的字典</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.context_processor()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inject_foo</span>():</span></span><br><span class="line">foo = <span class="string">&quot;I am foo&quot;</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">dict</span>(foo=foo)</span><br></pre></td></tr></table></figure>
<p>当我们调用<code>render_template()</code>函数渲染任意一个模板时，所有使用<code>app.context_processor</code>装饰器注册注册的模板上下文处理函数（包括flask内置的上下文处理函数）都会被执行，这些函数的返回值会被添加到模板中，因此我们可以直接在模板中使用<code>foo</code>变量</p>
<p>除了使用<code>app.context_processor</code>装饰器，也可以直接将其作为方法调用，传入模板上下文处理函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inject_foo</span>():</span></span><br><span class="line">foo = <span class="string">&quot;I am foo&quot;</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">dict</span>(foo=foo)</span><br><span class="line"></span><br><span class="line">app.context_processor(inject_foo)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="全局对象"><a href="#全局对象" class="headerlink" title="全局对象"></a>全局对象</h2><p>全局对象是指在所有的模板中都可以直接使用的对象</p>
<h3 id="内置全局函数"><a href="#内置全局函数" class="headerlink" title="内置全局函数"></a>内置全局函数</h3><p>Jinjia2在模板中默认提供了一些全局函数，常用的三个函数</p>
<table>
<thead>
<tr>
<th align="left">函数</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">range([start, ] stop[, step])</td>
<td align="left">和python中range()用法相同</td>
</tr>
<tr>
<td align="left">lipsum(n=5, html=True, min=20, max=100)</td>
<td align="left">生成随机文本，可以在测试时调用来填充页面，默认生成5段html文本，每段包含20～100个单词</td>
</tr>
<tr>
<td align="left">dict(**items)</td>
<td align="left">和python中dict()用法相同</td>
</tr>
</tbody></table>
<p>flask在模板中内置了两个全局函数</p>
<table>
<thead>
<tr>
<th align="left">函数</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">url_for()</td>
<td align="left">用于生成url</td>
</tr>
<tr>
<td align="left">get_flashed_messages()</td>
<td align="left">获取flash消息</td>
</tr>
</tbody></table>
<p>url_for()传入视图端点</p>
<h3 id="自定义全局函数"><a href="#自定义全局函数" class="headerlink" title="自定义全局函数"></a>自定义全局函数</h3><p>我们可以使用<code>app.template_global</code>装饰器直接将函数注册为模板全局函数。默认使用函数名称传入模板，在<code>app.template_global()</code>装饰器中使用name参数可以指定一个自定义名称。</p>
<h2 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h2><p>在jinja2中，过滤器是一些可以用来修改和过滤变量值的特殊函数，过滤器和变量之间用<code>|</code>隔开，需要参数的过滤器可以用括号进行传递</p>
<h4 id="例子1"><a href="#例子1" class="headerlink" title="例子1"></a>例子1</h4><p><code>&#123;&#123;name|title&#125;&#125;</code> 这会将name变量的值标题化，相当于在Python中调用<code>name.title()</code></p>
<h4 id="例子2"><a href="#例子2" class="headerlink" title="例子2"></a>例子2</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">另一种方法时将过滤器作用于一部分模板数据，使用&#96;filter&#96;和&#96;endfilter&#96;标签声明开始和结束</span><br><span class="line">&#96;&#96;&#96;jinjia2</span><br><span class="line">&#123;%filter upper%&#125;</span><br><span class="line">    This text will be uppercase.</span><br><span class="line">&#123;%endfilter%&#125;</span><br></pre></td></tr></table></figure>
<h3 id="内置过滤器"><a href="#内置过滤器" class="headerlink" title="内置过滤器"></a>内置过滤器</h3><table>
<thead>
<tr>
<th align="left">过滤器</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">default(value, default_value=u’’, boolean=False)</td>
<td align="left">设置默认值，默认值作为参数传入，别名为d</td>
</tr>
<tr>
<td align="left">escape(s)</td>
<td align="left">转移html文本，别名为e</td>
</tr>
<tr>
<td align="left">first(seq)</td>
<td align="left">返回序列的第一个元素</td>
</tr>
<tr>
<td align="left">last(seq)</td>
<td align="left">返回序列的最后一个元素</td>
</tr>
<tr>
<td align="left">length(object)</td>
<td align="left">返回变量的长度</td>
</tr>
<tr>
<td align="left">random(seq)</td>
<td align="left">返回序列中的随机元素</td>
</tr>
<tr>
<td align="left">safe(value)</td>
<td align="left">将变量值标记为安全，避免转义</td>
</tr>
<tr>
<td align="left">更多过滤器请访问<a target="_blank" rel="noopener" href="http://jinja.procc.org/docs/2.10/templates/#builtin-filters">http://jinja.procc.org/docs/2.10/templates/#builtin-filters</a></td>
<td align="left"></td>
</tr>
</tbody></table>
<p>在使用过滤器时，列表中过滤器函数的第一个参数表示被过滤的变量值(value)或字符串(s)，即竖线符号左侧的值，其他参数可以通过添加括号传入，另外过滤器可以叠加使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;Hello, &#123;&#123;name|default(&#39;陌生人&#39;)|title&#125;&#125;!&lt;&#x2F;h1&gt;</span><br></pre></td></tr></table></figure>
<h3 id="自定义过滤器"><a href="#自定义过滤器" class="headerlink" title="自定义过滤器"></a>自定义过滤器</h3><p>使用<code>app.template_filter()</code>装饰器可以注册自定义过滤器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">from flask import Markup</span><br><span class="line"></span><br><span class="line">@app.template_filter()</span><br><span class="line">def musical(s):</span><br><span class="line">    return s+Markup(&#39; &amp;#9835&#39;) # 在变量字符后添加一个音符图标，用markup将其标记为安全字符</span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<p>和注册全局函数类似，可以在app.template_filter()中使用name关键字设置过滤器的名称，默认为函数名称。   </br><br>过滤器需要接受被处理的值为输入，返回处理后的值。</p>
<h2 id="模板组织结构"><a href="#模板组织结构" class="headerlink" title="模板组织结构"></a>模板组织结构</h2><h3 id="局部模板"><a href="#局部模板" class="headerlink" title="局部模板"></a>局部模板</h3><p>在web程序中，我们通常会为每一页面编写一个独立的模板，比如主页模板，设置模板，这些模板可以<strong>直接在试图函数中渲染并作为html响应主体</strong></br><br>除了这类模板我们还会用到另一类非独立模板，被称为<strong>局部模板或次模板</strong>，因为他们仅包含部分代码，使用不会再视图函数中直接渲染它，而是插入到其他独立模板中。</br><br>为了避免重复，当多个独立模板中都会使用同一块html代码时，我们可以把这部分代码抽离出来，存储在局部模板中。比如多个页面都要在顶部显示一个提示条，这个横幅抗议定义在局部模板<code>_banner.html</code>中。</br><br>使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% inlcude &#39;_banner.html&#39; %&#125;</span><br></pre></td></tr></table></figure>
<p>来插入一个局部模板，这会吧局部模板的全部内容插在此标签的位置。</p>
<h3 id="宏"><a href="#宏" class="headerlink" title="宏"></a>宏</h3><p>宏类似于python里的函数。使用宏可以把一部分模板代码封装到宏里，使用传递的参数来构建内容，最后返回构建后的内容。功能上和局部模板相似，都是为了方便代码块的重用。</br><br>在创建宏时使用<code>macro</code>和<code>endmacro</code>标签声明宏的开始和结束，在开始标签中定义宏的名称和接收的参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% macro qux(amount&#x3D;1) %&#125;</span><br><span class="line">    &#123;% if amount &#x3D;&#x3D; 1 %&#125;</span><br><span class="line">        i am qux</span><br><span class="line">    &#123;% elif amount &gt;1 %&#125;</span><br><span class="line">        we are quxs</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endmacro %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>使用示例</p>

{% from 'macros.html' import qux %}</br>
...</br>
{{ qux(amount=5) }}</br>


<h3 id="模板继承"><a href="#模板继承" class="headerlink" title="模板继承"></a>模板继承</h3><p>当子模板继承基模板后，子模板会包含基模板的内容和结构，为了让子模板能插入或覆盖内容到基模板中，我们需要在<strong>基模板</strong>中定义block。在子模板中使用{% extend 'base.html' %}来声明扩展基模板。<br><em>extend必须是子模板的第一个标签！</em></p>
<h4 id="覆盖内容"><a href="#覆盖内容" class="headerlink" title="覆盖内容"></a>覆盖内容</h4><p>当在子模板里创建同名的块时，会用子块内容覆盖父块内容</p>
<h4 id="追加内容"><a href="#追加内容" class="headerlink" title="追加内容"></a>追加内容</h4><p>如果想向基模板的块中追加内容，需要用<code>super()</code>函数声明</p>

{% block styles %}</br>
{{ super() }}</br>
<style></br>
    .foo{color:red}</br>
</style></br>
{% endblock %}</br>



<h2 id="加载静态文件"><a href="#加载静态文件" class="headerlink" title="加载静态文件"></a>加载静态文件</h2><p>Flask中默认需要将静态文件存储在与主脚本（包含程序实例的脚本）同级目录的static文件夹中， 如果想在其他文件夹中储存静态文件，可以在在实例化Flask类是使用<code>static_folder</code>参数指定，静态文件的url路径中的static也会自动随着文件夹名称变化。</br><br>为了在html文件中引用静态文件，需要用<code>url_for()</code>函数获取静态文件url。flask内置了用于获取静态文件的师徒函数，端点值为static，它的默认url规则为<code>static/&lt;path:filename&gt;</code>，url变量filename是相对于static文件夹根目录的文件路径。</p>
<h3 id="添加favicon（网站头像）"><a href="#添加favicon（网站头像）" class="headerlink" title="添加favicon（网站头像）"></a>添加favicon（网站头像）</h3><p>在static文件夹下放入favicon文件，命名为favicon.ico，然后再html页面中声明favicon路径</p>

<link rel="icon" type="image/x-icon" href={{url_for('static', filename='favicon.ico')}}>


<h2 id="消息闪现"><a href="#消息闪现" class="headerlink" title="消息闪现"></a>消息闪现</h2><p>flask提供的<code>flash()</code>函数发送消息储存在session中，在模板中使用全局函数<code>get_flashed_messages()</code>获取消息，并将其显示出来。 </br><br>通过flash()函数发送的消息储存在session中，所以我们需要为程序设置密钥，可以通过<code>app.secret_key</code>属性或者配置环境变量<code>SECRET_KEY</code>设置</p>
<p>示例</p>

from flask import Flask, render_template, flash</br>

app = Flask(__name__)</br>
app.secret_key = 'secret string'</br>

@app.route('/flash')</br>
def just_flash():</br>
flash('i am flash')</br>
return redirect(url_for('index'))</br>


<p>在templates中的代码如下</p>

<main></br>
    {% for message in get_flashed_messages() %}</br>
        <div class="alert"> {{message}} </div></br>
    {% endfor %}</br>
    {% block content %} {% endblock %}</br>
</main></br>


<h2 id="自定义错误页面"><a href="#自定义错误页面" class="headerlink" title="自定义错误页面"></a>自定义错误页面</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask, render_template</span><br><span class="line">...</span><br><span class="line">@app.errorhandler(404)</span><br><span class="line">def page_not_found(e):</span><br><span class="line">    return render_template(&#39;errors&#x2F;404.html&#39;), 404   </span><br></pre></td></tr></table></figure>
<p>错误处理函数接收异常对象为参数，异常对象提供了以下常用属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">code  状态码</span><br><span class="line">name    原因短语</span><br><span class="line">description 错误描述</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/flask/" rel="tag"># flask</a>
          
            <a href="/tags/%E6%A8%A1%E6%9D%BF/" rel="tag"># 模板</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/10/23/iocaozuo/" rel="next" title="c++文件操作">
                <i class="fa fa-chevron-left"></i> c++文件操作
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/11/08/cppshuzuchuancan/" rel="prev" title="C++ 数组传参">
                C++ 数组传参 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">44</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">76</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E8%AF%AD%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">模板语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E7%A7%8D%E7%95%8C%E5%AE%9A%E7%AC%A6"><span class="nav-number">1.1.</span> <span class="nav-text">三种界定符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#for%E5%BE%AA%E7%8E%AF%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.</span> <span class="nav-text">for循环特殊变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%B2%E6%9F%93%E6%A8%A1%E6%9D%BF"><span class="nav-number">1.3.</span> <span class="nav-text">渲染模板</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7"><span class="nav-number">2.</span> <span class="nav-text">模板辅助工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="nav-number">2.1.</span> <span class="nav-text">上下文</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E7%BD%AE%E4%B8%8A%E4%B8%8B%E6%96%87%E5%8F%98%E9%87%8F"><span class="nav-number">2.1.1.</span> <span class="nav-text">内置上下文变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="nav-number">2.1.2.</span> <span class="nav-text">自定义上下文</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.</span> <span class="nav-text">全局对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E7%BD%AE%E5%85%A8%E5%B1%80%E5%87%BD%E6%95%B0"><span class="nav-number">3.1.</span> <span class="nav-text">内置全局函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.</span> <span class="nav-text">自定义全局函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">4.</span> <span class="nav-text">过滤器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%901"><span class="nav-number">4.0.1.</span> <span class="nav-text">例子1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%902"><span class="nav-number">4.0.2.</span> <span class="nav-text">例子2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E7%BD%AE%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">4.1.</span> <span class="nav-text">内置过滤器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">4.2.</span> <span class="nav-text">自定义过滤器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E7%BB%84%E7%BB%87%E7%BB%93%E6%9E%84"><span class="nav-number">5.</span> <span class="nav-text">模板组织结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%80%E9%83%A8%E6%A8%A1%E6%9D%BF"><span class="nav-number">5.1.</span> <span class="nav-text">局部模板</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%8F"><span class="nav-number">5.2.</span> <span class="nav-text">宏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E7%BB%A7%E6%89%BF"><span class="nav-number">5.3.</span> <span class="nav-text">模板继承</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A6%86%E7%9B%96%E5%86%85%E5%AE%B9"><span class="nav-number">5.3.1.</span> <span class="nav-text">覆盖内容</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%BD%E5%8A%A0%E5%86%85%E5%AE%B9"><span class="nav-number">5.3.2.</span> <span class="nav-text">追加内容</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6"><span class="nav-number">6.</span> <span class="nav-text">加载静态文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0favicon%EF%BC%88%E7%BD%91%E7%AB%99%E5%A4%B4%E5%83%8F%EF%BC%89"><span class="nav-number">6.1.</span> <span class="nav-text">添加favicon（网站头像）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B6%88%E6%81%AF%E9%97%AA%E7%8E%B0"><span class="nav-number">7.</span> <span class="nav-text">消息闪现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%94%99%E8%AF%AF%E9%A1%B5%E9%9D%A2"><span class="nav-number">8.</span> <span class="nav-text">自定义错误页面</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">baichen</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  


  

  

</body>
</html>
